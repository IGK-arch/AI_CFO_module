// Генерация сценариев для разных отраслей

import { Scenario } from './types';

interface IndustryScenarios {
  [key: string]: Scenario[];
}

export const industryScenarios: IndustryScenarios = {
  retail: [
    {
      id: 'retail-seasonal-peak',
      name: 'Новогодний бум продаж',
      description: 'Пик продаж в ноябре-декабре: выручка +150%, но нужен запас товара',
      impact: {
        revenue: 2.5,
        costs: 1.8,
        cashFlow: 1.4,
      },
      probability: 0.9,
      timeframe: 'short',
      recommendations: [
        'Заранее закупить товар на склад (сентябрь-октябрь)',
        'Нанять временный персонал за месяц',
        'Обеспечить кредитную линию на 2-3 млн руб',
        'Договориться с поставщиками об отсрочке',
      ],
      risks: [
        'Непроданный товар после праздников',
        'Кассовый разрыв при закупке',
        'Нехватка персонала в пик',
      ],
    },
    {
      id: 'retail-summer-slump',
      name: 'Летний спад продаж',
      description: 'Июль-август: падение выручки на 40%, но расходы остаются',
      impact: {
        revenue: 0.6,
        costs: 0.95,
        cashFlow: 0.3,
      },
      probability: 0.95,
      timeframe: 'short',
      recommendations: [
        'Создать резерв 1-2 млн руб к июню',
        'Провести летние распродажи',
        'Сократить закупки на 50%',
        'Отправить персонал в отпуска',
      ],
      risks: [
        'Кассовый разрыв в июле-августе',
        'Невозможность оплатить аренду',
        'Необходимость экстренного кредита',
      ],
    },
    {
      id: 'retail-expansion',
      name: 'Открытие нового магазина',
      description: 'Инвестиции 5 млн руб, окупаемость 18 месяцев',
      impact: {
        revenue: 1.6,
        costs: 2.2,
        cashFlow: -3.0,
      },
      probability: 0.5,
      timeframe: 'long',
      recommendations: [
        'Привлечь кредит 3-4 млн руб',
        'Начинать в феврале-марте (не перед сезоном)',
        'Первые 6 месяцев - убытки 300-500 тыс/мес',
        'Резерв на операционку минимум 2 млн руб',
      ],
      risks: [
        'Низкая посещаемость первые месяцы',
        'Недостаток оборотных средств',
        'Конкуренция в новой локации',
      ],
    },
  ],
  
  services: [
    {
      id: 'services-large-client',
      name: 'Крупный клиент с отсрочкой',
      description: 'Контракт 5 млн руб/год, но оплата через 60 дней',
      impact: {
        revenue: 2.0,
        costs: 1.3,
        cashFlow: -0.5,
      },
      probability: 0.7,
      timeframe: 'medium',
      recommendations: [
        'Факторинг дебиторки под 8-10%',
        'Договориться об авансе 30%',
        'Нанять команду за 2 месяца до старта',
        'Кредитная линия 2 млн руб',
      ],
      risks: [
        'Кассовый разрыв первые 2 месяца',
        'Клиент задерживает оплату еще дольше',
        'Нехватка средств на зарплату',
      ],
    },
    {
      id: 'services-team-expansion',
      name: 'Расширение команды',
      description: 'Найм 5 специалистов: +400 тыс/мес расходов, рост выручки через 3 месяца',
      impact: {
        revenue: 1.5,
        costs: 1.4,
        cashFlow: -1.2,
      },
      probability: 0.8,
      timeframe: 'medium',
      recommendations: [
        'Резерв 1.5 млн руб на 4 месяца',
        'Начинать при runway > 12 мес',
        'Сначала взять 2-3 человека, потом остальных',
        'Договориться с новыми клиентами заранее',
      ],
      risks: [
        'Новички не приносят прибыль первые месяцы',
        'Не найдены новые клиенты',
        'Кассовый разрыв через 2-3 месяца',
      ],
    },
    {
      id: 'services-project-failure',
      name: 'Срыв крупного проекта',
      description: 'Клиент отменяет контракт на 3 млн руб, потеря 40% выручки',
      impact: {
        revenue: 0.6,
        costs: 0.95,
        cashFlow: 0.4,
      },
      probability: 0.3,
      timeframe: 'short',
      recommendations: [
        'Диверсифицировать клиентов (не > 30% от 1 клиента)',
        'Резерв на 3-6 месяцев',
        'Быстро искать замену (1-2 недели)',
        'Временно сократить зарплаты или персонал',
      ],
      risks: [
        'Банкротство при отсутствии резерва',
        'Необходимость срочного кредита',
        'Потеря репутации',
      ],
    },
  ],
  
  ecommerce: [
    {
      id: 'ecommerce-viral-growth',
      name: 'Вирусный рост после рекламы',
      description: 'Заказы x10 за неделю: нужно масштабировать все',
      impact: {
        revenue: 10.0,
        costs: 8.0,
        cashFlow: -2.0,
      },
      probability: 0.2,
      timeframe: 'short',
      recommendations: [
        'Кредит 5-10 млн руб на товар',
        'Договориться с логистикой заранее',
        'Автоматизация обработки заказов',
        'Временные склады и персонал',
      ],
      risks: [
        'Не хватит товара (упущенная выручка)',
        'Логистика не справится',
        'Кассовый разрыв из-за роста',
      ],
    },
    {
      id: 'ecommerce-returns-wave',
      name: 'Волна возвратов (брак)',
      description: 'Партия брака: 30% возвратов, репутационный ущерб',
      impact: {
        revenue: 0.5,
        costs: 1.2,
        cashFlow: 0.3,
      },
      probability: 0.15,
      timeframe: 'short',
      recommendations: [
        'Страховка качества товара',
        'Резерв 2-3 млн руб на возвраты',
        'Быстрая замена брака (1-2 дня)',
        'Компенсация клиентам (скидки)',
      ],
      risks: [
        'Потеря репутации',
        'Блокировка на маркетплейсах',
        'Судебные иски',
      ],
    },
    {
      id: 'ecommerce-marketplace-commission',
      name: 'Повышение комиссии маркетплейса',
      description: 'Комиссия с 10% до 20%: падение маржи в 2 раза',
      impact: {
        revenue: 1.0,
        costs: 1.2,
        cashFlow: 0.7,
      },
      probability: 0.4,
      timeframe: 'medium',
      recommendations: [
        'Запустить свой интернет-магазин',
        'Поднять цены на 10-15%',
        'Оптимизировать расходы на 20%',
        'Договориться об индивидуальных условиях',
      ],
      risks: [
        'Падение продаж при росте цен',
        'Потеря маржинальности',
        'Необходимость смены бизнес-модели',
      ],
    },
  ],
  
  construction: [
    {
      id: 'construction-payment-delay',
      name: 'Задержка платежа от заказчика',
      description: 'Заказчик задерживает 40% оплаты (10 млн) на 3 месяца',
      impact: {
        revenue: 1.0,
        costs: 1.0,
        cashFlow: -2.0,
      },
      probability: 0.5,
      timeframe: 'short',
      recommendations: [
        'Кредитная линия 5-10 млн руб',
        'Факторинг под уступку',
        'Отсрочка оплаты поставщикам',
        'Страхование рисков',
      ],
      risks: [
        'Остановка работ',
        'Невозможность платить поставщикам',
        'Штрафы за срыв сроков',
      ],
    },
    {
      id: 'construction-materials-price',
      name: 'Рост цен на материалы',
      description: 'Цены на стройматериалы +40%, маржа съедена',
      impact: {
        revenue: 1.0,
        costs: 1.4,
        cashFlow: 0.5,
      },
      probability: 0.6,
      timeframe: 'medium',
      recommendations: [
        'Закупать материалы заранее',
        'Индексация цен в договорах',
        'Альтернативные поставщики',
        'Пересмотр бюджета проекта',
      ],
      risks: [
        'Работа в убыток',
        'Конфликт с заказчиком',
        'Необходимость доп. финансирования',
      ],
    },
    {
      id: 'construction-new-project',
      name: 'Взять 2 проекта одновременно',
      description: 'Удвоение объема: нужно 20 млн оборотки',
      impact: {
        revenue: 2.5,
        costs: 2.3,
        cashFlow: -3.0,
      },
      probability: 0.4,
      timeframe: 'long',
      recommendations: [
        'Кредит 15-20 млн руб',
        'Найм 2 бригад (50 человек)',
        'Лизинг доп. техники',
        'Резерв на 3-4 месяца',
      ],
      risks: [
        'Нехватка оборотных средств',
        'Проблемы с качеством',
        'Срыв сроков',
      ],
    },
  ],
  
  manufacturing: [
    {
      id: 'manufacturing-equipment-upgrade',
      name: 'Модернизация оборудования',
      description: 'Покупка нового станка: 3 млн руб, +50% производительности',
      impact: {
        revenue: 1.5,
        costs: 3.0,
        cashFlow: -2.5,
      },
      probability: 0.7,
      timeframe: 'long',
      recommendations: [
        'Лизинг оборудования (350 тыс/мес)',
        'Начинать при runway > 12 мес',
        'Обучение персонала 1-2 месяца',
        'Окупаемость 18-24 месяца',
      ],
      risks: [
        'Долгая окупаемость',
        'Проблемы с техникой',
        'Нехватка заказов',
      ],
    },
    {
      id: 'manufacturing-raw-materials',
      name: 'Закупка сырья впрок',
      description: 'Купить древесину на год вперед: скидка 20%, но нужно 5 млн',
      impact: {
        revenue: 1.0,
        costs: 5.0,
        cashFlow: -4.0,
      },
      probability: 0.5,
      timeframe: 'medium',
      recommendations: [
        'Кредит под товар 4-5 млн руб',
        'Аренда доп. склада',
        'Страхование товара',
        'Экономия 1 млн руб/год',
      ],
      risks: [
        'Порча материалов',
        'Падение цен',
        'Кассовый разрыв',
      ],
    },
    {
      id: 'manufacturing-b2b-contract',
      name: 'Крупный B2B контракт',
      description: 'Поставки на 20 млн/год, но первый платеж через 90 дней',
      impact: {
        revenue: 2.0,
        costs: 1.5,
        cashFlow: -1.5,
      },
      probability: 0.6,
      timeframe: 'long',
      recommendations: [
        'Факторинг дебиторки',
        'Аванс минимум 30%',
        'Кредитная линия 3-5 млн',
        'Поэтапные поставки',
      ],
      risks: [
        'Кассовый разрыв первые месяцы',
        'Клиент откажется',
        'Не справимся с объемом',
      ],
    },
  ],
  
  logistics: [
    {
      id: 'logistics-fuel-price',
      name: 'Рост цен на топливо',
      description: 'Бензин +30%: расходы +500 тыс/мес',
      impact: {
        revenue: 1.0,
        costs: 1.3,
        cashFlow: 0.7,
      },
      probability: 0.7,
      timeframe: 'short',
      recommendations: [
        'Топливные карты с фиксированной ценой',
        'Повысить тарифы на 10-15%',
        'Оптимизация маршрутов',
        'Переход на электромобили',
      ],
      risks: [
        'Потеря рентабельности',
        'Отказ клиентов при росте тарифов',
        'Убыточные рейсы',
      ],
    },
    {
      id: 'logistics-fleet-expansion',
      name: 'Расширение автопарка',
      description: '5 новых грузовиков: 10 млн в лизинг, +70% выручки',
      impact: {
        revenue: 1.7,
        costs: 1.5,
        cashFlow: -8.0,
      },
      probability: 0.5,
      timeframe: 'long',
      recommendations: [
        'Лизинг 10 млн (500 тыс/мес)',
        'Найм 8 водителей',
        'Новые контракты на 3-4 млн/мес',
        'Резерв на первые 3 месяца',
      ],
      risks: [
        'Не найдены заказы',
        'Простой техники',
        'Высокие лизинговые платежи',
      ],
    },
    {
      id: 'logistics-accident',
      name: 'Серьезное ДТП',
      description: 'Авария с грузом: ремонт 800 тыс, компенсация 1.5 млн',
      impact: {
        revenue: 0.95,
        costs: 2.3,
        cashFlow: -1.0,
      },
      probability: 0.2,
      timeframe: 'short',
      recommendations: [
        'КАСКО + страхование груза',
        'Резерв 2-3 млн руб',
        'Контроль усталости водителей',
        'Видеорегистраторы',
      ],
      risks: [
        'Потеря репутации',
        'Потеря клиента',
        'Судебные иски',
      ],
    },
  ],
};

// Функция для получения сценариев по отрасли
export function getIndustryScenarios(industryId: string): Scenario[] {
  return industryScenarios[industryId] || [];
}

